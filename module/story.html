<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë§¥ë½ ê¸°ì–µ - ìˆœì„œ ë§ì¶”ê¸° (Prototype)</title>
  <style>
    :root { --bg:#0b0f14; --card:#121925; --muted:#8aa0b8; --text:#e8f0fb; --accent:#6aa6ff; --ok:#3ad29f; --bad:#ff5a6a; }
    * { box-sizing: border-box; }
    body {
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, #1b2b42 0%, transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, #202a3b 0%, transparent 55%),
                  var(--bg);
      color: var(--text);
    }
    .wrap { max-width: 920px; margin: 0 auto; padding: 22px 16px 40px; }
    .top {
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;
      margin-bottom: 14px;
    }
    .title {
      display:flex; flex-direction:column; gap:6px;
    }
    h1 { margin:0; font-size: 20px; letter-spacing: -0.2px; }
    .sub { margin:0; color: var(--muted); font-size: 13px; line-height: 1.4; }
    .pill {
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px; border-radius: 999px;
      background: rgba(255,255,255,0.06);
      color: var(--muted); font-size: 12px;
    }
    .board {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.09);
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .storyBox { margin-top: 10px; padding: 12px; border-radius: 14px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.07); }
    .storyTitle { font-size: 14px; margin: 0 0 6px; }
    .storyHint { margin:0; color: var(--muted); font-size: 13px; line-height:1.45; }

    .list {
      margin-top: 12px;
      display:flex; flex-direction:column; gap:10px;
      padding: 10px;
      border-radius: 14px;
      background: rgba(0,0,0,0.18);
      border: 1px dashed rgba(255,255,255,0.12);
      min-height: 220px;
    }
    .item {
      display:flex; gap:10px; align-items:flex-start;
      padding: 12px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      cursor: grab;
      user-select: none;
    }
    .item:active { cursor: grabbing; }
    .num {
      width: 28px; height: 28px; border-radius: 10px;
      background: rgba(106,166,255,0.18);
      border: 1px solid rgba(106,166,255,0.35);
      display:flex; align-items:center; justify-content:center;
      color: var(--accent); font-weight: 700; font-size: 12px;
      flex: 0 0 auto;
    }
    .txt { font-size: 14px; line-height: 1.5; color: var(--text); }
    .item.dragging { opacity: 0.55; transform: scale(0.99); }
    .item.over { outline: 2px solid rgba(106,166,255,0.55); }

    .btns { display:flex; gap:10px; flex-wrap:wrap; }
    button {
      border: 0; border-radius: 12px;
      padding: 10px 12px;
      font-size: 13px;
      background: rgba(255,255,255,0.08);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.12);
      cursor:pointer;
    }
    button:hover { background: rgba(255,255,255,0.11); }
    button.primary {
      background: rgba(106,166,255,0.18);
      border: 1px solid rgba(106,166,255,0.40);
      color: #dcebff;
    }
    button.danger {
      background: rgba(255,90,106,0.14);
      border: 1px solid rgba(255,90,106,0.35);
    }
    .status {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
      min-height: 44px;
      display:flex; align-items:center;
    }
    .status.ok { color: #b9ffe7; border-color: rgba(58,210,159,0.35); background: rgba(58,210,159,0.10); }
    .status.bad { color: #ffd0d6; border-color: rgba(255,90,106,0.35); background: rgba(255,90,106,0.10); }
    .footer {
      margin-top: 14px; color: rgba(138,160,184,0.9); font-size: 12px; line-height: 1.5;
    }
    .kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
      padding: 2px 6px; border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="title">
        <h1>ë§¥ë½ ê¸°ì–µ: ìˆœì„œ ë§ì¶”ê¸°</h1>
        <p class="sub">ë¬¸ì¥(ë˜ëŠ” ì§§ì€ ì¥ë©´)ì„ ë“œë˜ê·¸í•´ì„œ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë°°ì—´í•´ë³´ì„¸ìš”. <span class="kbd">ì •ë‹µ í™•ì¸</span>ì„ ëˆ„ë¥´ë©´ ì±„ì í•©ë‹ˆë‹¤.</p>
      </div>
      <div class="pill">
        <span>ì§„í–‰</span>
        <strong id="progressText">1 / 5</strong>
      </div>
    </div>

    <div class="board">
      <div class="row">
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <div class="pill">ë‚œì´ë„: <strong id="levelText">ì‰¬ì›€</strong></div>
          <div class="pill">ì‹œë„: <strong id="triesText">0</strong></div>
        </div>
        <div class="btns">
          <button id="btnShuffle" class="danger" type="button">ë‹¤ì‹œ ì„ê¸°</button>
          <button id="btnHint" type="button">íŒíŠ¸</button>
          <button id="btnCheck" class="primary" type="button">ì •ë‹µ í™•ì¸</button>
          <button id="btnNext" type="button" disabled>ë‹¤ìŒ</button>
        </div>
      </div>

      <div class="storyBox">
        <p class="storyTitle"><strong id="storyTitle">â€”</strong></p>
        <p class="storyHint" id="storyDesc">â€”</p>
      </div>

      <div class="list" id="list"></div>

      <div class="status" id="status">
        ë¬¸ì¥ ì¹´ë“œë¥¼ ë“œë˜ê·¸í•´ì„œ ìˆœì„œë¥¼ ë°”ê¾¼ ë’¤, <strong style="margin-left:6px;">ì •ë‹µ í™•ì¸</strong>ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.
      </div>

      <div class="footer">
        <div>â€¢ ì ‘ê·¼ì„±/ê³ ë ¹ì¸µ ê³ ë ¤: í° ë²„íŠ¼, ì§§ì€ ë¬¸ì¥, ì‹¤íŒ¨ íŒ¨ë„í‹° ì—†ìŒ</div>
        <div>â€¢ ìš´ì˜ ì•„ì´ë””ì–´: â€œì˜¤ëŠ˜ì˜ ê¸°ì‚¬ ìš”ì•½ 3ë¬¸ì¥ ìˆœì„œ ë§ì¶”ê¸°â€ë¡œ ë§¤ì¼ 1ê°œ ì œê³µ</div>
      </div>
    </div>
  </div>

  <script>
    // ES6 ìµœì†Œí™”(ì‚¬ìš©ì ì„ í˜¸): var/function ìœ„ì£¼ë¡œ ì‘ì„±

    var stories = [
      {
        title: "ì•„ì¹¨ ë£¨í‹´",
        desc: "ì¼ìƒ íë¦„ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ë„ë¡ ìˆœì„œë¥¼ ë§ì¶°ë³´ì„¸ìš”.",
        level: "ì‰¬ì›€",
        steps: [
          "ì•ŒëŒì´ ìš¸ë ¤ ëˆˆì„ ëœ¬ë‹¤.",
          "ì„¸ìˆ˜ë¥¼ í•˜ê³  ì´ë¥¼ ë‹¦ëŠ”ë‹¤.",
          "ì•„ì¹¨ì„ ê°„ë‹¨íˆ ë¨¹ëŠ”ë‹¤.",
          "ê°€ë°©ì„ ì±™ê²¨ ì§‘ì„ ë‚˜ì„ ë‹¤."
        ]
      },
      {
        title: "ì¹´í˜ì—ì„œ ì£¼ë¬¸í•˜ê¸°",
        desc: "ì‹¤ì œë¡œ ê²½í—˜í•˜ëŠ” ìˆœì„œë¥¼ ë– ì˜¬ë¦¬ë©´ ì‰½ê²Œ ë§ì¶œ ìˆ˜ ìˆì–´ìš”.",
        level: "ì‰¬ì›€",
        steps: [
          "ë©”ë‰´ë¥¼ ë³´ê³  ë§ˆì‹¤ ê²ƒì„ ê³ ë¥¸ë‹¤.",
          "ì¹´ìš´í„°ì—ì„œ ì£¼ë¬¸í•˜ê³  ê²°ì œí•œë‹¤.",
          "ì§„ë™ë²¨(ë˜ëŠ” í˜¸ì¶œ)ì„ ê¸°ë‹¤ë¦°ë‹¤.",
          "ìŒë£Œë¥¼ ë°›ì•„ ìë¦¬ë¡œ ê°„ë‹¤."
        ]
      },
      {
        title: "ë¹„ ì˜¤ëŠ” ë‚  ìš°ì‚°",
        desc: "ì›ì¸â†’í–‰ë™â†’ê²°ê³¼ íë¦„ì„ ìƒê°í•´ë³´ì„¸ìš”.",
        level: "ë³´í†µ",
        steps: [
          "ë°–ì— ë¹„ê°€ ì˜¤ëŠ”ì§€ í™•ì¸í•œë‹¤.",
          "ìš°ì‚°ì„ ì±™ê¸°ê±°ë‚˜ ìš°ë¹„ë¥¼ ì¤€ë¹„í•œë‹¤.",
          "ë°–ìœ¼ë¡œ ë‚˜ê°€ ì´ë™í•œë‹¤.",
          "ì –ì§€ ì•Šê²Œ ìš°ì‚°ì„ ì ‘ê³  ì •ë¦¬í•œë‹¤."
        ]
      },
      {
        title: "íƒë°° ë°›ê¸°",
        desc: "ì¤‘ê°„ ë‹¨ê³„ë¥¼ ë¹ ëœ¨ë¦¬ì§€ ì•ŠëŠ” ê²Œ í¬ì¸íŠ¸ì…ë‹ˆë‹¤.",
        level: "ë³´í†µ",
        steps: [
          "íƒë°° ë„ì°© ì•Œë¦¼ì„ í™•ì¸í•œë‹¤.",
          "ë¬¸ ì•(ë˜ëŠ” ê²½ë¹„ì‹¤/ë¬´ì¸í•¨)ìœ¼ë¡œ ê°„ë‹¤.",
          "íƒë°°ë¥¼ ì°¾ì•„ ì§‘ ì•ˆìœ¼ë¡œ ì˜®ê¸´ë‹¤.",
          "í¬ì¥ì„ ëœ¯ê³  ë‚´ìš©ë¬¼ì„ í™•ì¸í•œë‹¤."
        ]
      },
      {
        title: "ê¸°ì‚¬ ì½ê³  ê³µìœ í•˜ê¸°(ì–¸ë¡ ì‚¬í˜•)",
        desc: "ë‰´ìŠ¤ ì†Œë¹„ íë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤.",
        level: "ë³´í†µ",
        steps: [
          "ì œëª©ì„ ë³´ê³  ê´€ì‹¬ ê¸°ì‚¬ë¥¼ ì„ íƒí•œë‹¤.",
          "ë³¸ë¬¸ì„ ì½ìœ¼ë©° í•µì‹¬ì„ íŒŒì•…í•œë‹¤.",
          "í•µì‹¬ ë‚´ìš©ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ë¦¬í•œë‹¤.",
          "ê°€ì¡±/ì§€ì¸ì—ê²Œ ë§í¬ë¥¼ ê³µìœ í•œë‹¤."
        ]
      }
    ];

    var idx = 0;
    var tries = 0;
    var hintShown = false;
    var dragSrcEl = null;

    function $(id){ return document.getElementById(id); }

    function shuffleArray(arr) {
      // Fisher-Yates
      var a = arr.slice();
      for (var i = a.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var tmp = a[i]; a[i] = a[j]; a[j] = tmp;
      }
      return a;
    }

    function setStatus(msg, kind) {
      var el = $("status");
      el.className = "status";
      if (kind === "ok") el.className = "status ok";
      if (kind === "bad") el.className = "status bad";
      el.innerHTML = msg;
    }

    function renderStory() {
      var s = stories[idx];
      $("storyTitle").innerHTML = s.title;
      $("storyDesc").innerHTML = s.desc;
      $("levelText").innerHTML = s.level;
      $("progressText").innerHTML = (idx + 1) + " / " + stories.length;
      $("triesText").innerHTML = String(tries);

      $("btnNext").disabled = true;
      hintShown = false;

      // ì„ì–´ì„œ ë Œë”ë§
      var mixed = shuffleArray(s.steps);
      renderList(mixed);

      setStatus("ë¬¸ì¥ ì¹´ë“œë¥¼ ë“œë˜ê·¸í•´ì„œ ìˆœì„œë¥¼ ë°”ê¾¼ ë’¤, <strong style='margin-left:6px;'>ì •ë‹µ í™•ì¸</strong>ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.", "");
    }

    function renderList(items) {
      var list = $("list");
      list.innerHTML = "";

      for (var i = 0; i < items.length; i++) {
        var div = document.createElement("div");
        div.className = "item";
        div.setAttribute("draggable", "true");
        div.setAttribute("data-text", items[i]);

        var num = document.createElement("div");
        num.className = "num";
        num.innerHTML = String(i + 1);

        var txt = document.createElement("div");
        txt.className = "txt";
        txt.innerHTML = items[i];

        div.appendChild(num);
        div.appendChild(txt);

        bindDnD(div);
        list.appendChild(div);
      }
      renumber();
    }

    function renumber() {
      var list = $("list");
      var kids = list.children;
      for (var i = 0; i < kids.length; i++) {
        var num = kids[i].querySelector(".num");
        if (num) num.innerHTML = String(i + 1);
      }
    }

    function bindDnD(el) {
      el.addEventListener("dragstart", function(e){
        dragSrcEl = el;
        el.classList.add("dragging");
        e.dataTransfer.effectAllowed = "move";
        try { e.dataTransfer.setData("text/plain", el.getAttribute("data-text")); } catch (err) {}
      });

      el.addEventListener("dragend", function(){
        el.classList.remove("dragging");
        clearOver();
        renumber();
      });

      el.addEventListener("dragover", function(e){
        e.preventDefault();
        e.dataTransfer.dropEffect = "move";
        el.classList.add("over");
      });

      el.addEventListener("dragleave", function(){
        el.classList.remove("over");
      });

      el.addEventListener("drop", function(e){
        e.preventDefault();
        if (!dragSrcEl || dragSrcEl === el) return;

        var list = $("list");
        var children = list.children;

        // í˜„ì¬ el ìœ„ì¹˜ì— dragSrcElì„ ë¼ì›Œë„£ê¸°
        var srcIndex = indexOfChild(children, dragSrcEl);
        var dstIndex = indexOfChild(children, el);

        if (srcIndex < 0 || dstIndex < 0) return;

        if (srcIndex < dstIndex) {
          list.insertBefore(dragSrcEl, el.nextSibling);
        } else {
          list.insertBefore(dragSrcEl, el);
        }

        clearOver();
        renumber();
      });
    }

    function clearOver() {
      var list = $("list");
      var kids = list.children;
      for (var i = 0; i < kids.length; i++) kids[i].classList.remove("over");
    }

    function indexOfChild(htmlCollection, node) {
      for (var i = 0; i < htmlCollection.length; i++) {
        if (htmlCollection[i] === node) return i;
      }
      return -1;
    }

    function getCurrentOrder() {
      var list = $("list");
      var kids = list.children;
      var out = [];
      for (var i = 0; i < kids.length; i++) {
        out.push(kids[i].getAttribute("data-text"));
      }
      return out;
    }

    function arraysEqual(a, b) {
      if (!a || !b) return false;
      if (a.length !== b.length) return false;
      for (var i = 0; i < a.length; i++) {
        if (a[i] !== b[i]) return false;
      }
      return true;
    }

    function showHint() {
      if (hintShown) {
        setStatus("íŒíŠ¸ëŠ” ì´ë¯¸ í‘œì‹œí–ˆì–´ìš”. ë‹¤ì‹œ í•œ ë²ˆ ì •ë‹µ íë¦„(ì›ì¸â†’í–‰ë™â†’ê²°ê³¼)ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš”.", "");
        return;
      }
      hintShown = true;

      var s = stories[idx];
      // íŒíŠ¸: 1ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ ë¬¸ì¥ì„ ì•Œë ¤ì£¼ê¸°(ë‚œì´ë„ ì¡°ì ˆ ê°€ëŠ¥)
      var msg = "íŒíŠ¸: <strong>ì²« ë¬¸ì¥</strong>ì€ â€œ" + s.steps[0] + "â€, <strong>ë§ˆì§€ë§‰ ë¬¸ì¥</strong>ì€ â€œ" + s.steps[s.steps.length - 1] + "â€ ì…ë‹ˆë‹¤.";
      setStatus(msg, "");
    }

    function checkAnswer() {
      tries += 1;
      $("triesText").innerHTML = String(tries);

      var s = stories[idx];
      var now = getCurrentOrder();
      var ok = arraysEqual(now, s.steps);

      if (ok) {
        $("btnNext").disabled = false;
        setStatus("ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰ ë§¥ë½ íë¦„ì´ ì •í™•í•´ìš”. <strong style='margin-left:6px;'>ë‹¤ìŒ</strong>ìœ¼ë¡œ ë„˜ì–´ê°€ë„ ë©ë‹ˆë‹¤.", "ok");
      } else {
        // ë¶€ë¶„ í”¼ë“œë°±: ë§ëŠ” ìœ„ì¹˜ ê°œìˆ˜
        var correctPos = 0;
        for (var i = 0; i < s.steps.length; i++) {
          if (now[i] === s.steps[i]) correctPos += 1;
        }
        setStatus("ì•„ì‰½ì§€ë§Œ ì•„ì§ ì•„ë‹ˆì—ìš”. ë§ëŠ” ìœ„ì¹˜: <strong>" + correctPos + "</strong> / " + s.steps.length + "  (íƒ€ì´ë¨¸ ì—†ì´ ì²œì²œíˆ ë‹¤ì‹œ ë°°ì—´í•´ë³´ì„¸ìš”)", "bad");
      }
    }

    function reshuffle() {
      var s = stories[idx];
      renderList(shuffleArray(s.steps));
      setStatus("ë¬¸ì¥ì„ ë‹¤ì‹œ ì„ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆì—” íë¦„(ì›ì¸â†’í–‰ë™â†’ê²°ê³¼)ìœ¼ë¡œ ì ‘ê·¼í•´ë³´ì„¸ìš”.", "");
      $("btnNext").disabled = true;
    }

    function nextStory() {
      idx += 1;
      tries = 0;
      if (idx >= stories.length) {
        // ì¢…ë£Œ í™”ë©´
        $("btnNext").disabled = true;
        $("btnCheck").disabled = true;
        $("btnHint").disabled = true;
        $("btnShuffle").disabled = true;

        $("storyTitle").innerHTML = "ì™„ë£Œ!";
        $("storyDesc").innerHTML = "í”„ë¡œí† íƒ€ì… ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëª¨ë‘ í’€ì—ˆìŠµë‹ˆë‹¤. ìš´ì˜ ì‹œì—ëŠ” ë§¤ì¼ 1ê°œ(3~4ë¬¸ì¥)ë¡œ ì œê³µí•˜ë©´ ì¬ë°©ë¬¸ì— ìœ ë¦¬í•©ë‹ˆë‹¤.";
        $("levelText").innerHTML = "â€”";
        $("progressText").innerHTML = stories.length + " / " + stories.length;

        $("list").innerHTML = "";
        setStatus("ìˆ˜ê³ í–ˆì–´ìš”! âœ…", "ok");
        return;
      }
      renderStory();
    }

    // ë²„íŠ¼ ë°”ì¸ë”©
    $("btnHint").addEventListener("click", showHint);
    $("btnCheck").addEventListener("click", checkAnswer);
    $("btnShuffle").addEventListener("click", reshuffle);
    $("btnNext").addEventListener("click", nextStory);

    // ì‹œì‘
    renderStory();
  </script>
</body>
</html>
