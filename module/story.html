<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>ë‘ë‡Œ íŠ¼íŠ¼ - ìˆœì„œ ë§ì¶”ê¸°</title>
  <style>
    /* 1. ê°€ë…ì„±ì„ ìœ„í•œ ê¸°ë³¸ ì„¤ì • */
    :root {
      --bg-color: #f4f6f8;
      --card-bg: #ffffff;
      --text-main: #111111;
      --text-sub: #555555;
      --primary: #2b7fff; /* ì„ ëª…í•œ íŒŒë€ìƒ‰ */
      --correct: #28a745; /* ì„ ëª…í•œ ì´ˆë¡ìƒ‰ */
      --wrong: #dc3545;   /* ì„ ëª…í•œ ë¹¨ê°„ìƒ‰ */
      --border: #dde0e3;
    }

    body {
      margin: 0;
      padding: 20px 10px;
      font-family: "Pretendard", "Noto Sans KR", sans-serif;
      background-color: var(--bg-color);
      color: var(--text-main);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    /* 2. ì»¨í…Œì´ë„ˆ: í­ì„ ë„“ê²Œ ì¡ë˜ ì¤‘ì•™ ì •ë ¬ */
    .container {
      width: 100%;
      max-width: 600px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      padding: 24px;
      box-sizing: border-box;
    }

    /* 3. í—¤ë”: í¬ê³  ëª…í™•í•˜ê²Œ */
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    h1 {
      margin: 0 0 10px;
      font-size: 26px;
      color: var(--primary);
    }
    p.desc {
      margin: 0;
      font-size: 18px;
      color: var(--text-sub);
      line-height: 1.5;
    }

    /* 4. ì§„í–‰ ìƒíƒœ ë°” */
    .progress-bar {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-bottom: 30px;
    }
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ddd;
    }
    .dot.active { background: var(--primary); }

    /* 5. ì •ë‹µ ì¹¸ (Slots) */
    .slots-area {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 40px;
      padding: 16px;
      background-color: #f9f9f9;
      border-radius: 16px;
      border: 2px dashed #ccc;
    }
    .slot-label {
      font-size: 16px;
      color: var(--text-sub);
      margin-bottom: 4px;
      font-weight: bold;
    }
    
    .slot {
      min-height: 64px;
      background: #fff;
      border: 2px solid var(--border);
      border-radius: 12px;
      display: flex;
      align-items: center;
      padding: 10px 16px;
      font-size: 20px;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.03);
      position: relative;
    }
    
    /* ë¹„ì–´ìˆì„ ë•Œ ìˆ«ì í‘œì‹œ */
    .slot.empty::before {
      content: attr(data-num);
      position: absolute;
      left: 16px;
      color: #ddd;
      font-size: 24px;
      font-weight: bold;
    }
    
    /* ì±„ì›Œì¡Œì„ ë•Œ ìŠ¤íƒ€ì¼ */
    .slot.filled {
      border-color: var(--primary);
      background-color: #eef6ff;
      color: var(--primary);
    }
    .slot.filled::after {
      content: "âœ•"; /* ì·¨ì†Œ ì•„ì´ì½˜ */
      position: absolute;
      right: 16px;
      color: var(--primary);
      opacity: 0.6;
    }

    /* 6. ë³´ê¸° ë²„íŠ¼ë“¤ (Options) */
    .options-area {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .option-btn {
      background: #fff;
      border: 2px solid #bbb;
      color: #333;
      padding: 16px;
      border-radius: 12px;
      font-size: 20px;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
    }
    .option-btn:active {
      transform: scale(0.98);
      background: #eee;
    }
    /* ì„ íƒëœ ë³´ê¸°ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ (íë¦¬ê²Œ) */
    .option-btn.selected {
      opacity: 0.3;
      pointer-events: none;
      background: #eee;
      border-color: #eee;
    }

    /* 7. ê²°ê³¼ ë©”ì‹œì§€ ë° ë²„íŠ¼ */
    .result-area {
      margin-top: 30px;
      text-align: center;
      min-height: 80px;
    }
    .message {
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 16px;
    }
    .message.good { color: var(--correct); }
    .message.bad { color: var(--wrong); }

    .action-btn {
      width: 100%;
      padding: 18px;
      font-size: 22px;
      font-weight: bold;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      color: #fff;
      background-color: var(--primary);
    }
    .action-btn:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    .action-btn.retry {
      background-color: #666;
    }

  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1>ë‘ë‡Œ íŠ¼íŠ¼ í€´ì¦ˆ</h1>
      <p class="desc" id="storyTitle">ìˆœì„œëŒ€ë¡œ ëˆŒëŸ¬ë³´ì„¸ìš”</p>
    </header>

    <div class="progress-bar" id="progressBar">
      </div>

    <div class="slots-area" id="slotsArea">
      </div>

    <div class="options-area" id="optionsArea">
      </div>

    <div class="result-area">
      <div id="message" class="message"></div>
      <button id="mainBtn" class="action-btn" onclick="checkAnswer()">ì •ë‹µ í™•ì¸í•˜ê¸°</button>
    </div>
  </div>

  <script>
    // ë°ì´í„°: ì–´ë¥´ì‹ ë“¤ì—ê²Œ ìµìˆ™í•œ ì¼ìƒ ì†Œì¬
    const quizData = [
      {
        title: "ì™¸ì¶œ ì¤€ë¹„ í•˜ê¸°",
        steps: ["ì„¸ìˆ˜ë¥¼ í•œë‹¤", "ì˜·ì„ ì…ëŠ”ë‹¤", "ì‹ ë°œì„ ì‹ ëŠ”ë‹¤"]
      },
      {
        title: "ë¼ë©´ ë“ì´ê¸°",
        steps: ["ë¬¼ì„ ë“ì¸ë‹¤", "ë©´ê³¼ ìŠ¤í”„ë¥¼ ë„£ëŠ”ë‹¤", "ë§›ìˆê²Œ ë¨¹ëŠ”ë‹¤"]
      },
      {
        title: "ì „í™” ê±¸ê¸°",
        steps: ["ìˆ˜í™”ê¸°ë¥¼ ë“ ë‹¤", "ë²ˆí˜¸ë¥¼ ëˆ„ë¥¸ë‹¤", "ìƒëŒ€ë°©ê³¼ í†µí™”í•œë‹¤"]
      }
    ];

    let currentIdx = 0;
    let currentSlots = [null, null, null]; // í˜„ì¬ ì±„ì›Œì§„ ë‹µ (ì¸ë±ìŠ¤ ì €ì¥)
    let isFinished = false;

    const els = {
      title: document.getElementById('storyTitle'),
      progress: document.getElementById('progressBar'),
      slots: document.getElementById('slotsArea'),
      options: document.getElementById('optionsArea'),
      msg: document.getElementById('message'),
      btn: document.getElementById('mainBtn')
    };

    function initQuiz() {
      // 1. í™”ë©´ ì´ˆê¸°í™”
      currentSlots = [null, null, null];
      isFinished = false;
      els.msg.textContent = "";
      els.msg.className = "message";
      
      els.btn.textContent = "ì •ë‹µ í™•ì¸í•˜ê¸°";
      els.btn.className = "action-btn";
      els.btn.onclick = checkAnswer;
      els.btn.disabled = true; // ë‹¤ ì±„ìš°ê¸° ì „ì—” ë¹„í™œì„±

      const data = quizData[currentIdx];
      els.title.textContent = `[ë¬¸ì œ ${currentIdx + 1}] ${data.title}`;

      // 2. ì§„í–‰ë°” ì—…ë°ì´íŠ¸
      els.progress.innerHTML = '';
      quizData.forEach((_, i) => {
        const dot = document.createElement('div');
        dot.className = `dot ${i === currentIdx ? 'active' : ''}`;
        els.progress.appendChild(dot);
      });

      // 3. ìŠ¬ë¡¯(ë¹ˆì¹¸) ìƒì„±
      renderSlots();

      // 4. ë³´ê¸° ë²„íŠ¼ ìƒì„± (ì„ì–´ì„œ)
      renderOptions(data.steps);
    }

    function renderSlots() {
      els.slots.innerHTML = "";
      // í•­ìƒ 3ë‹¨ê³„ë¡œ ê³ ì • (ë³µì¡ë„ ë‚®ì¶¤)
      for(let i=0; i<3; i++) {
        const slot = document.createElement('div');
        slot.className = currentSlots[i] ? "slot filled" : "slot empty";
        slot.setAttribute('data-num', i + 1); // 1, 2, 3 ìˆ«ì
        
        // ë‚´ìš©ì´ ìˆìœ¼ë©´ í…ìŠ¤íŠ¸ í‘œì‹œ, ì—†ìœ¼ë©´ ë¹ˆì¹¸
        if (currentSlots[i]) {
          slot.textContent = currentSlots[i].text;
          // í´ë¦­ ì‹œ ì·¨ì†Œ ê¸°ëŠ¥ (ë‹¤ì‹œ ë‚´ë ¤ë³´ë‚´ê¸°)
          slot.onclick = () => removeSlot(i);
        } else {
          slot.textContent = "";
        }
        els.slots.appendChild(slot);
      }
      
      // ë²„íŠ¼ í™œì„±/ë¹„í™œì„± ì²´í¬
      const allFilled = currentSlots.every(s => s !== null);
      els.btn.disabled = !allFilled;
    }

    function renderOptions(originalSteps) {
      els.options.innerHTML = "";
      
      // í€´ì¦ˆ ì‹œì‘í•  ë•Œë§Œ ì„ê³ , ê·¸ ë’¤ë¡œëŠ” ìƒíƒœë§Œ ë³€ê²½í•´ì•¼ í•¨
      // ì—¬ê¸°ì„œëŠ” ê°„ëµí™”ë¥¼ ìœ„í•´ ë§¤ë²ˆ DOMì„ ë‹¤ì‹œ ê·¸ë¦¼ (ì‚¬ìš©ì ê²½í—˜ìƒ ë¬¸ì œ ì—†ìŒ)
      
      // í˜„ì¬ ì˜µì…˜ë“¤ì´ ì„ì—¬ìˆëŠ” ìˆœì„œê°€ í•„ìš”í•˜ë¯€ë¡œ, 
      // ì´ˆê¸°í™” ì‹œì ì— ì„ì–´ë‘” ë°°ì—´ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìœ¼ë‚˜, 
      // ì½”ë“œë¥¼ ë‹¨ìˆœí•˜ê²Œ í•˜ê¸° ìœ„í•´ í™”ë©´ì— ë¿Œë¦´ ë•Œ ì„ì¸ ë°°ì—´ì„ ìƒì„±.
      // *ì£¼ì˜: ë Œë”ë§ í•  ë•Œë§ˆë‹¤ ì„ìœ¼ë©´ ì•ˆë˜ë¯€ë¡œ id ê¸°ë°˜ ê´€ë¦¬*
      
      if (!this.shuffledOptions) {
        this.shuffledOptions = originalSteps.map((text, idx) => ({ text, originalIdx: idx }));
        shuffleArray(this.shuffledOptions);
      }

      this.shuffledOptions.forEach((opt, idx) => {
        const btn = document.createElement('div');
        btn.className = "option-btn";
        btn.textContent = opt.text;
        
        // ì´ë¯¸ ìŠ¬ë¡¯ì— ì˜¬ë¼ê°€ ìˆëŠ” ë…€ì„ì¸ì§€ í™•ì¸
        const isUsed = currentSlots.some(s => s && s.text === opt.text);
        if (isUsed) {
          btn.classList.add('selected');
        } else {
          btn.onclick = () => selectOption(opt);
        }

        els.options.appendChild(btn);
      });
    }

    function selectOption(optItem) {
      // ë¹ˆ ìŠ¬ë¡¯ ì°¾ê¸°
      const emptyIdx = currentSlots.findIndex(item => item === null);
      if (emptyIdx === -1) return; // ê½‰ ì°¼ìœ¼ë©´ ë¬´ì‹œ

      // ìŠ¬ë¡¯ì— ë°ì´í„° ì±„ìš°ê¸°
      currentSlots[emptyIdx] = optItem;
      
      // í™”ë©´ ê°±ì‹ 
      renderSlots();
      renderOptions(); // ì˜µì…˜ ë²„íŠ¼ ìƒíƒœ ê°±ì‹ 
    }

    function removeSlot(slotIdx) {
      if (isFinished) return; // ëë‚¬ìœ¼ë©´ ìˆ˜ì • ë¶ˆê°€
      currentSlots[slotIdx] = null;
      renderSlots();
      renderOptions();
    }

    function checkAnswer() {
      const data = quizData[currentIdx];
      // ì‚¬ìš©ìê°€ ë§ì¶˜ ìˆœì„œëŒ€ë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
      const userAnswers = currentSlots.map(s => s.text);
      
      // ì •ë‹µ ë¹„êµ
      const isCorrect = JSON.stringify(userAnswers) === JSON.stringify(data.steps);

      if (isCorrect) {
        els.msg.textContent = "ì •ë‹µì…ë‹ˆë‹¤! ì°¸ ì˜í•˜ì…¨ì–´ìš” ğŸ‘";
        els.msg.className = "message good";
        els.btn.textContent = "ë‹¤ìŒ ë¬¸ì œ í’€ê¸°";
        els.btn.className = "action-btn";
        els.btn.onclick = nextQuiz;
        isFinished = true;
      } else {
        els.msg.textContent = "ìˆœì„œê°€ ì¡°ê¸ˆ ë‹¤ë¥¸ ê²ƒ ê°™ì•„ìš”. ë‹¤ì‹œ í•´ë³´ì„¸ìš”.";
        els.msg.className = "message bad";
        
        // í‹€ë ¸ì„ ë•Œ ì‹œê°ì  íš¨ê³¼ (í”ë“¤ê¸° ëŒ€ì‹  ë¹¨ê°„ í…Œë‘ë¦¬ ì ê¹)
        els.slots.style.borderColor = "var(--wrong)";
        setTimeout(() => els.slots.style.borderColor = "#ccc", 1000);
      }
    }

    function nextQuiz() {
      currentIdx++;
      if (currentIdx >= quizData.length) {
        // ëª¨ë“  ë¬¸ì œ ì™„ë£Œ
        document.body.innerHTML = `
          <div class="container" style="text-align:center; padding-top:50px;">
            <h1 style="color:var(--primary)">ê±´ê°•í•œ ë‘ë‡Œ!</h1>
            <p style="font-size:20px; line-height:1.6;">ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ ë§ì¶”ì…¨ìŠµë‹ˆë‹¤.<br>ì˜¤ëŠ˜ë„ ì¦ê±°ìš´ í•˜ë£¨ ë³´ë‚´ì„¸ìš”.</p>
            <button class="action-btn" onclick="location.reload()" style="margin-top:30px;">ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°</button>
          </div>
        `;
      } else {
        this.shuffledOptions = null; // ë‹¤ìŒ ë¬¸ì œë¥¼ ìœ„í•´ ì„ê¸° ì´ˆê¸°í™”
        initQuiz();
      }
    }

    // ë°°ì—´ ì„ê¸° ìœ í‹¸
    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    // ì‹œì‘
    initQuiz();

  </script>
</body>
</html>
